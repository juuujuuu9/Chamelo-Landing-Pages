{{ 'index-promise-product-new.css' | asset_url | stylesheet_tag }}

<div class="Index_promise_product_main_new">
  <div class="Index_promise_product_inner_new">
    <div class="Index_promise_product_left_new">
      <div class="Index_promise_product_header_new">
        {%- if section.settings.heading_small != blank -%}
          <p class="Index_promise_product_header_small_new">{{ section.settings.heading_small }}</p>
        {%- endif -%}
        {%- if section.settings.heading_large != blank -%}
          <h2 class="Index_promise_product_header_large_new">{{ section.settings.heading_large }}</h2>
        {%- endif -%}
      </div>

      {%- if section.blocks.size > 0 -%}
        <div class="Index_promise_product_badges_new">
          {%- for block in section.blocks -%}
            {%- if block.type == 'trust_badge' -%}
              <div class="Index_promise_product_badge_new" {{ block.shopify_attributes }}>
                {%- if block.settings.icon != blank -%}
                  <div class="Index_promise_product_badge_icon_new">
                    {{
                      block.settings.icon |
                      image_url: width: 80 |
                      image_tag: widths: '40, 80',
                      fetchpriority: 'lazy',
                      class: 'Index_promise_product_badge_icon_img_new'
                    }}
                  </div>
                {%- else -%}
                  <div class="Index_promise_product_badge_icon_new Index_promise_product_badge_icon_default_new">
                    <svg width="42" height="42" viewBox="0 0 42 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="21" cy="21" r="20" stroke="#000" stroke-width="1.5"/>
                      <path d="M14 21L19 26L28 17" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                {%- endif -%}
                {%- if block.settings.text != blank -%}
                  <p class="Index_promise_product_badge_text_new">{{ block.settings.text }}</p>
                {%- endif -%}
                {%- if block.settings.description != blank -%}
                  <p class="Index_promise_product_badge_desc_new">{{ block.settings.description }}</p>
                {%- endif -%}
              </div>
              {%- unless forloop.last -%}
                <div class="Index_promise_product_badge_divider_new"></div>
              {%- endunless -%}
            {%- endif -%}
          {%- endfor -%}
        </div>
      {%- endif -%}

      {%- if section.settings.button_text != blank and section.settings.button_link != blank -%}
        <a href="{{ section.settings.button_link }}" class="Index_promise_product_cta_button_new">
          {{ section.settings.button_text }}
        </a>
      {%- endif -%}
    </div>

    <div class="Index_promise_product_right_new">
      {%- assign featured_product = all_products[section.settings.featured_product] -%}
      {%- if featured_product != blank -%}
        <div class="Index_promise_product_card_new">
          <div class="Index_promise_product_card_image_new">
            {%- if featured_product.featured_image != blank -%}
              <a href="{{ featured_product.url }}">
                {{
                  featured_product.featured_image |
                  image_url: width: 700 |
                  image_tag: widths: '350, 500, 700',
                  fetchpriority: 'lazy',
                  class: 'Index_promise_product_card_img_new'
                }}
              </a>
            {%- endif -%}
          </div>

          <div class="Index_promise_product_card_details_new">
            <div class="Index_promise_product_card_info_new">
              <div class="Index_promise_product_card_rating_new">
                <div class="Index_promise_product_card_stars_new">
                  {%- for i in (1..5) -%}
                    <svg width="13" height="12" viewBox="0 0 13 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M6.5 0L8.16 4.08L12.6 4.58L9.3 7.52L10.18 11.88L6.5 9.77L2.82 11.88L3.7 7.52L0.4 4.58L4.84 4.08L6.5 0Z" fill="#000"/>
                    </svg>
                  {%- endfor -%}
                </div>
                <span class="Index_promise_product_card_rating_count_new">
                  ({{ featured_product.metafields.reviews.rating_count | default: '0' }})
                </span>
              </div>
              <a href="{{ featured_product.url }}" class="Index_promise_product_card_name_new">{{ featured_product.title }}</a>
              <p class="Index_promise_product_card_price_new">{{ featured_product.price | money }}</p>
            </div>

            <div class="Index_promise_product_card_variants_new">
              <div class="Index_promise_product_card_color_label_new">
                <span class="Index_promise_product_card_color_title_new">Frame Color</span>
              </div>
              <div class="Index_promise_product_card_variant_thumbs_new">
                {%- for variant in featured_product.variants limit: 4 -%}
                  <div class="Index_promise_product_card_variant_thumb_new {% if forloop.first %}active{% endif %}" data-variant-id="{{ variant.id }}">
                    {%- if variant.featured_image != blank -%}
                      {{
                        variant.featured_image |
                        image_url: width: 80 |
                        image_tag: widths: '40, 80',
                        fetchpriority: 'lazy',
                        class: 'Index_promise_product_card_variant_img_new'
                      }}
                    {%- endif -%}
                  </div>
                {%- endfor -%}
              </div>
            </div>

            <a href="{{ featured_product.url }}" class="Index_promise_product_card_view_btn_new">
              VIEW PRODUCT
            </a>
          </div>
        </div>
      {%- else -%}
        {%- if section.settings.featured_image != blank -%}
          <div class="Index_promise_product_card_new">
            <div class="Index_promise_product_card_image_new Index_promise_product_card_image_static_new">
              {{
                section.settings.featured_image |
                image_url: width: 700 |
                image_tag: widths: '350, 500, 700',
                fetchpriority: 'lazy',
                class: 'Index_promise_product_card_img_new'
              }}
            </div>
          </div>
        {%- endif -%}
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Index Promise Product",
    "class": "Index_promise_product_section_new",
    "settings": [
      {
        "type": "text",
        "id": "heading_small",
        "label": "Small Heading",
        "default": "OUR PROMISE"
      },
      {
        "type": "textarea",
        "id": "heading_large",
        "label": "Large Heading",
        "default": "Upgrade your shades with confidence"
      },
      {
        "type": "text",
        "id": "button_text",
        "label": "Button Text",
        "default": "SHOP ALL PRODUCTS"
      },
      {
        "type": "url",
        "id": "button_link",
        "label": "Button Link"
      },
      {
        "type": "product",
        "id": "featured_product",
        "label": "Featured Product"
      },
      {
        "type": "image_picker",
        "id": "featured_image",
        "label": "Featured Image (if no product selected)"
      }
    ],
    "blocks": [
      {
        "type": "trust_badge",
        "name": "Trust Badge",
        "limit": 4,
        "settings": [
          {
            "type": "image_picker",
            "id": "icon",
            "label": "Badge Icon"
          },
          {
            "type": "text",
            "id": "text",
            "label": "Badge Text",
            "default": "30-DAY GUARANTEE"
          },
          {
            "type": "text",
            "id": "description",
            "label": "Badge Description"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Index Promise Product",
        "blocks": [
          { "type": "trust_badge" },
          { "type": "trust_badge" },
          { "type": "trust_badge" },
          { "type": "trust_badge" }
        ]
      }
    ]
  }
{% endschema %}
